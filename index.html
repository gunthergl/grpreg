<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Regularization Paths for Regression Models with Grouped Covariates â€¢ grpreg</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/cerulean/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><link href="extra.css" rel="stylesheet">
<script src="extra.js"></script><meta property="og:title" content="Regularization Paths for Regression Models with Grouped Covariates">
<meta property="og:description" content="Efficient algorithms for fitting the regularization path of linear
  regression, GLM, and Cox regression models with grouped penalties.  This
  includes group selection methods such as group lasso, group MCP, and
  group SCAD as well as bi-level selection methods such as the group
  exponential lasso, the composite MCP, and the group bridge.">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">grpreg</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.2.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Learn more
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/web/models.html">Models</a>
    </li>
    <li>
      <a href="articles/web/penalties.html">Penalties</a>
    </li>
  </ul>
</li>
<li>
  <a href="reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/pbreheny/grpreg">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    

    
    
<div id="regularization-paths-for-regression-models-with-grouped-covariates" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#regularization-paths-for-regression-models-with-grouped-covariates" class="anchor"></a>Regularization Paths for Regression Models with Grouped Covariates</h1></div>
<p><code>grpreg</code> is an R package for fitting the regularization path of linear regression, GLM, and Cox regression models with grouped penalties. This includes group selection methods such as group lasso, group MCP, and group SCAD as well as bi-level selection methods such as the group exponential lasso, the composite MCP, and the group bridge. Utilities for carrying out cross-validation as well as post-fitting visualization, summarization, and prediction are also provided.</p>
<p>This site focuses on illustrating the usage and syntax of <code>grpreg</code>. For more on the algorithms used by <code>grpreg</code>, see the original articles:</p>
<ul>
<li><p><a href="http://myweb.uiowa.edu/pbreheny/pdf/Breheny2009.pdf">Breheny, P. and Huang, J. (2009) Penalized methods for bi-level variable selection. <em>Statistics and its interface</em>, <strong>2</strong>: 369-380.</a></p></li>
<li><p><a href="http://www.springerlink.com/openurl.asp?genre=article&amp;id=doi:10.1007/s11222-013-9424-2">Breheny, P. and Huang, J. (2015) Group descent algorithms for nonconvex penalized linear and logistic regression models with grouped predictors. <em>Statistics and Computing</em>, <strong>25</strong>: 173-187.</a></p></li>
</ul>
<p>For more information on specific penalties, including references describing the methods implemented by <code>grpreg</code> in greater detail, see <a href="http://pbreheny.github.io/grpreg/articles/web/penalties.html" class="uri">http://pbreheny.github.io/grpreg/articles/web/penalties.html</a>.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p><code>grpreg</code> is on CRAN, so it can be installed via:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/install.packages">install.packages</a></span>(<span class="st">"grpreg"</span>)</a></code></pre></div>
</div>
<div id="brief-introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#brief-introduction" class="anchor"></a>Brief introduction</h2>
<p>In regression modeling, variables are often grouped. For example, suppose we took the design matrix from the <code><a href="https://www.rdocumentation.org/packages/MASS/topics/birthwt">MASS::birthwt</a></code> data set and expanded its original variables by including multiple indicator functions for categorical variables such as race and basis expansions using polynomials or splines for the continuous variables:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(X)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="co">#             age1         age2         age3        lwt1        lwt2</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="co"># [1,] -0.05833434  0.011046300  0.029561818  0.12446282 -0.02133871</span></a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co"># [2,]  0.13436561  0.055245529 -0.096907046  0.06006722 -0.06922831</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="co"># [3,] -0.04457006 -0.009415469  0.045088774 -0.05918388  0.03746349</span></a>
<a class="sourceLine" id="cb2-6" title="6"><span class="co"># [4,] -0.03080577 -0.026243567  0.052489640 -0.05202881  0.02390664</span></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="co"># [5,] -0.07209862  0.035141739  0.004821882 -0.05441384  0.02832410</span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="co"># [6,] -0.03080577 -0.026243567  0.052489640 -0.01386846 -0.03296942</span></a>
<a class="sourceLine" id="cb2-9" title="9"><span class="co">#              lwt3 white black smoke ptl1 ptl2m ht ui ftv1 ftv2 ftv3m</span></a>
<a class="sourceLine" id="cb2-10" title="10"><span class="co"># [1,] -0.130731102     0     1     0    0     0  0  1    0    0     0</span></a>
<a class="sourceLine" id="cb2-11" title="11"><span class="co"># [2,] -0.033348413     0     0     0    0     0  0  0    0    0     1</span></a>
<a class="sourceLine" id="cb2-12" title="12"><span class="co"># [3,]  0.004618178     1     0     1    0     0  0  0    1    0     0</span></a>
<a class="sourceLine" id="cb2-13" title="13"><span class="co"># [4,]  0.019034579     1     0     1    0     0  0  1    0    1     0</span></a>
<a class="sourceLine" id="cb2-14" title="14"><span class="co"># [5,]  0.014571538     1     0     1    0     0  0  1    0    0     0</span></a>
<a class="sourceLine" id="cb2-15" title="15"><span class="co"># [6,]  0.049559472     0     0     0    0     0  0  0    0    0     0</span></a>
<a class="sourceLine" id="cb2-16" title="16">group</a>
<a class="sourceLine" id="cb2-17" title="17"><span class="co">#  [1] age   age   age   lwt   lwt   lwt   race  race  smoke ptl   ptl  </span></a>
<a class="sourceLine" id="cb2-18" title="18"><span class="co"># [12] ht    ui    ftv   ftv   ftv  </span></a>
<a class="sourceLine" id="cb2-19" title="19"><span class="co"># Levels: age lwt race smoke ptl ht ui ftv</span></a></code></pre></div>
<p>We can fit a penalized regression model to this data with:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">fit &lt;-<span class="st"> </span><span class="kw"><a href="reference/grpreg.html">grpreg</a></span>(X, y, group)</a></code></pre></div>
<p>By default, <code>grpreg</code> fits a linear regression model with a group lasso penalty. For more detail on other types of models available, see <a href="articles/web/models.html">here</a>. For more detail on other types of penalties available, see <a href="articles/web/penalties.html">here</a>.</p>
<p>Fitting a penalized regression model produces a path of coefficients, which we can plot with</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(fit)</a></code></pre></div>
<p><img src="index_files/figure-html/plot-1.png" width="480"></p>
<p>Notice that when a group enters the model (e.g., the green group), all of its coefficients become nonzero; this is what happens with group lasso models. To see what the coefficients are, we could use the <code>coef</code> function:</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef</a></span>(fit, <span class="dt">lambda=</span><span class="fl">0.05</span>)</a>
<a class="sourceLine" id="cb5-2" title="2"><span class="co"># (Intercept)        age1        age2        age3        lwt1        lwt2 </span></a>
<a class="sourceLine" id="cb5-3" title="3"><span class="co">#  3.02892181  0.14045229  0.62608119  0.37683684  0.74715315 -0.15825582 </span></a>
<a class="sourceLine" id="cb5-4" title="4"><span class="co">#        lwt3       white       black       smoke        ptl1       ptl2m </span></a>
<a class="sourceLine" id="cb5-5" title="5"><span class="co">#  0.58290856  0.18344777 -0.06107624 -0.18778377 -0.17422515  0.05710668 </span></a>
<a class="sourceLine" id="cb5-6" title="6"><span class="co">#          ht          ui        ftv1        ftv2       ftv3m </span></a>
<a class="sourceLine" id="cb5-7" title="7"><span class="co"># -0.29776948 -0.38050822  0.00000000  0.00000000  0.00000000</span></a></code></pre></div>
<p>Note that the number of physicianâ€™s visits (<code>ftv</code>) is not included in the model at <span class="math inline">\(\lambda=0.05\)</span>.</p>
<p>Typically, one would carry out cross-validation for the purposes of carrying out inference on the predictive accuracy of the model at various values of <span class="math inline">\(\lambda\)</span>.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">cvfit &lt;-<span class="st"> </span><span class="kw"><a href="reference/cv-grpreg.html">cv.grpreg</a></span>(X, y, group, <span class="dt">penalty=</span><span class="st">"grLasso"</span>)</a>
<a class="sourceLine" id="cb6-2" title="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(cvfit)</a></code></pre></div>
<p><img src="index_files/figure-html/cvplot-1.png" width="480"> The coefficients corresponding to the value of <span class="math inline">\(\lambda\)</span> that minimizes the cross-validation error can be obtained via <code>coef</code>:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/coef">coef</a></span>(cvfit)</a>
<a class="sourceLine" id="cb7-2" title="2"><span class="co"># (Intercept)        age1        age2        age3        lwt1        lwt2 </span></a>
<a class="sourceLine" id="cb7-3" title="3"><span class="co">#  3.04266435  0.01796227  1.35719728  0.79450972  1.62763897 -0.02972551 </span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="co">#        lwt3       white       black       smoke        ptl1       ptl2m </span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="co">#  1.19306399  0.26989807 -0.13012492 -0.26049856 -0.27044766  0.17744150 </span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="co">#          ht          ui        ftv1        ftv2       ftv3m </span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="co"># -0.50214565 -0.45515119  0.06555406  0.02083302 -0.10804918</span></a></code></pre></div>
<p>Predicted values can be obtained via <code>predict</code>, which has a number of options:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(cvfit, <span class="dt">X=</span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(X))                 <span class="co"># Predictions for new observations</span></a>
<a class="sourceLine" id="cb8-2" title="2"><span class="co"># [1] 2.542064 2.995053 3.047928 2.560593 2.575120 3.085732</span></a>
<a class="sourceLine" id="cb8-3" title="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(fit, <span class="dt">type=</span><span class="st">"ngroups"</span>, <span class="dt">lambda=</span><span class="fl">0.1</span>)  <span class="co"># Number of nonzero groups</span></a>
<a class="sourceLine" id="cb8-4" title="4"><span class="co"># [1] 5</span></a>
<a class="sourceLine" id="cb8-5" title="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(fit, <span class="dt">type=</span><span class="st">"groups"</span>, <span class="dt">lambda=</span><span class="fl">0.1</span>)   <span class="co"># Identity of nonzero groups</span></a>
<a class="sourceLine" id="cb8-6" title="6"><span class="co"># [1] "race"  "smoke" "ptl"   "ht"    "ui"</span></a>
<a class="sourceLine" id="cb8-7" title="7"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(fit, <span class="dt">type=</span><span class="st">"nvars"</span>, <span class="dt">lambda=</span><span class="fl">0.1</span>)    <span class="co"># Number of nonzero coefficients</span></a>
<a class="sourceLine" id="cb8-8" title="8"><span class="co"># [1] 7</span></a>
<a class="sourceLine" id="cb8-9" title="9"><span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/predict">predict</a></span>(fit, <span class="dt">type=</span><span class="st">"vars"</span>, <span class="dt">lambda=</span><span class="fl">0.1</span>)     <span class="co"># Identity of nonzero coefficients</span></a>
<a class="sourceLine" id="cb8-10" title="10"><span class="co"># white black smoke  ptl1 ptl2m    ht    ui </span></a>
<a class="sourceLine" id="cb8-11" title="11"><span class="co">#     7     8     9    10    11    12    13</span></a></code></pre></div>
<p>Note that the original fit (to the full data set) is returned as <code>cvfit$fit</code>; it is not necessary to call both <code>grpreg</code> and <code>cv.grpreg</code> to analyze a data set. Several other penalties are available, as are methods for logistic regression and Cox proportional hazards regression.</p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Download from CRAN at <br><a href="https://cloud.r-project.org/package=grpreg">https://â€‹cloud.r-project.org/â€‹package=grpreg</a>
</li>
<li>Browse source code at <br><a href="https://github.com/pbreheny/grpreg">https://â€‹github.com/â€‹pbreheny/â€‹grpreg</a>
</li>
<li>Report a bug at <br><a href="http://github.com/pbreheny/grpreg/issues">http://â€‹github.com/â€‹pbreheny/â€‹grpreg/â€‹issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="https://www.r-project.org/Licenses/GPL-3">GPL-3</a></li>
</ul>
</div>
<div class="citation">
<h2>Citation</h2>
<ul class="list-unstyled">
<li><a href="authors.html">Citing grpreg</a></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Patrick Breheny <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/000-0002-0650-1119" target="orcid.widget"><img src="https://members.orcid.org/sites/default/files/vector_iD_icon.svg" class="orcid" alt="ORCID" height="16"></a> </li>
<li><a href="authors.html">All authors...</a></li>
</ul>
</div>

      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Patrick Breheny.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
